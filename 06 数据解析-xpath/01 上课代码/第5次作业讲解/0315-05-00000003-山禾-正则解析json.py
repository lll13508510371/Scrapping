"""
1. 采集网址 https://haokan.baidu.com/tab/gaoxiao_new

2. 采集目标
	- 采集当前页面里面的数据
	- 需要需要采集以下数据:
		title 视频标题
		duration 视频时长
		fmplaycnt 播放量

    - 用正则表达式采集
"""
import requests
import re


url = 'https://haokan.baidu.com/web/video/feed?tab=gaoxiao_new&act=pcFeed&pd=pc&num=22&shuaxin_id=16750798920000'
headers = {
'authority': 'haokan.baidu.com',
'cookie': 'PSTM=1657895499; BIDUPSID=D26C29435949C22624426B7C5A1F52F3; BAIDUID=963EC08DDD8CA5647A50D2ED99D0CCF2:SL=0:NR=10:FG=1; BDUSS=UtTVEZhbDhBUFowNDJsZ25yNlotVVBpc29CaXlCbmlCTzJQRThBMmFxVkFNWEpqSVFBQUFBJCQAAAAAAAAAAAEAAAD9hL2nuti-~M~oMzEzNjQxOQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAECkSmNApEpjN; BDUSS_BFESS=UtTVEZhbDhBUFowNDJsZ25yNlotVVBpc29CaXlCbmlCTzJQRThBMmFxVkFNWEpqSVFBQUFBJCQAAAAAAAAAAAEAAAD9hL2nuti-~M~oMzEzNjQxOQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAECkSmNApEpjN; H_WISE_SIDS=219946_232280_231979_222624_234085_234044_219623_232777_234572_238145_234020_230584_232357_131861_238265_239761_234208_114551_232244_219566_234296_234426_235174_235513_236239_238755_240305_237837_236538_236653_239947_240889_240939_240447_240466_240742_241208_241177_240782_241248_240597_241282_240649_241296_241328_241349_240035_238226_241460_216839_224267_227932_213356_229967_211986_239898_238444_215730_237893_214799_239101_238511_223064_219943_238507_213033_228650_229154_234781_204916_226628_241245_241565_238073_240905_230288_239492_232628_241757_241794_241153_234433_241815_241850_241864_240204_241970_240734_241780_232630_242055_242218_242224_242271_242379_242374_241601_242267_241892_241698_242473_241785_222222_237964_237821_241548_242489; ZFY=YcKoCPvg:AtdhP20uu:B7X4npHvE5Hz0Xr1QnyDMiU178:C; BAIDUID_BFESS=963EC08DDD8CA5647A50D2ED99D0CCF2:SL=0:NR=10:FG=1; H_PS_PSSID=36558_37559_38113_38093_38054_37990_37799_37920_37874_38041_26350_37957_38098_38008_37881; BA_HECTOR=2h2g0k2481a52ga401agahaq1htf8401l; Hm_lvt_4aadd610dfd2f5972f1efee2653a2bc5=1675079792; Hm_lpvt_4aadd610dfd2f5972f1efee2653a2bc5=1675079792; ariaDefaultTheme=undefined; ab_sr=1.0.1_NTQ0ZWYxYjIwY2RjNDJiYTZkMDIwZmI4Mjg5NTQ0NDY4YjM5MjkwMGRiODQxNWFjMTNiNmE1ZWQ0OGY1OWVkMmI5MmVhMTg2NWQ1ZjM3NzQ5MTcxMzA1Y2E1YzI3YzJmZWQxNzUzMjRkN2NjYjJlNDBhZmE3OTBmNjQzYTAzNjNiMDJlMThmOWY4YTczYmQ4MmJhM2M3OTI5YWJkYzM1Zg==; reptileData=%7B%22data%22%3A%227188fd42a8f398a595d554ce899551b267f7d8be0cb74cc1c5d67d43c4975e5a9e88f3b0480349fadc3ea258777220587b2012ce1499225ac6856435c874f15155b900a3a5497e09866526283163ca529f3ed34a38db1efa6df56f1e31eead05%22%2C%22key_id%22%3A%2230%22%2C%22sign%22%3A%225732b84a%22%7D; RT="z=1&dm=baidu.com&si=cfonaoquf2d&ss=ldir9ah9&sl=2&tt=1vw&bcn=https%3A%2F%2Ffclog.baidu.com%2Flog%2Fweirwood%3Ftype%3Dperf&ld=2ly&cl=1gsi&ul=26h4&hd=26s5"',
'referer': 'https://haokan.baidu.com/tab/gaoxiao_new',
'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36',
}

response = requests.get(url=url, headers=headers)
json_dict = response.json()
print(json_dict)
print(response.text)

json_str = str(json_dict)

# 多次精确匹配会返回列表嵌套元组的数据结构
# {.*?, 'title': '(.*?)',.*?, 'duration': '(.*?)',.*?, 'fmplaycnt': '(.*?)',.*?'},
result = re.findall("\{.*?, 'title': '(.*?)',.*?, 'duration': '(.*?)',.*?, 'fmplaycnt': '(.*?)',.*?'\},", json_str, re.S)
print(result)

